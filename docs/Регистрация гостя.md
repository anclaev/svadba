## Варианты регистрации

1. QR-код
2. Персональная ссылка

## Процесс регистрации

1. Заполнение анкеты
2. Создание пароля
3. Контакты
4. Привязка Telegram

## Публичная регистрация

1. Имя
2. Сторона (жених/невеста)
3. Пароль
4. Привязка телеграмма

## Привязка телеграма

### Со стороны бота

Если гость нажал на кнопку в боте "Зарегистрироваться", то в Redis записывается токен подтверждения с ttl 10 минут в виде:

```json
t_id: telegram_verification_token
```

Далее бот присылает ссылку, ведущую в личный кабинет гостя:

```q
https://localhost/me?action=verify&t_id={telegram_id}&t_token={telegram_verification_token}
```

#### Если гость авторизован

Фронт отправляет запрос на бэк вида:

```q
https://localhost/api/telegram/verify&t_id={telegram_id}&t_token={telegram_verification_token}
```

Бэк сравнивает токен с тем, что лежит в Redis, и если всё ок, делает запись в бд и возвращает код 200

#### Если гость не авторизован

Фронт редиректит на страницу авторизации c предыдущими параметрами:

```q
https://localhost/auth&t_id={telegram_id}&t_token={telegram_verification_token}
```

После авторизации/регистрации пользователя возвращаемся к "Если гость авторизован".

### Со стороны клиента

Гость после регистрации либо в личном кабинете нажимает кнопку "Привязать Telegram" и его редиректит на ссылку:

```q
https://t.me/ElleSvadbaBot?start=verify{user_id}
```

После того, как пользователь нажимает кнопку "Запустить", бэк извлекает user_id, ищет пользователя и привязывает к нему Telegram, а после в боте приходит сообщение в духе "Вы успешно зарегистрировались в боте" и ему открывается доступ к командам для авторизованных пользователей.
